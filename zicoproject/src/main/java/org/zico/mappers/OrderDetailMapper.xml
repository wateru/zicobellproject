<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="org.zico.mappers.OrderDetailMapper">

<resultMap type="OrderDetail" id="OrderDetilMap">
 	<result property="orderNo" column="detail_order_no" />
 	<result property="menuNo" column="detail_menu_no" />
 	<result property="storeNo" column="detail_store_no" />
 	<result property="count" column="detail_count"/>
 	<result property="price" column="detail_price"/>
 	<result property="token" column="detail_token"/>
 	<result property="subTotal" column="detail_subtotal"/>
 	<result property="menuName" column="detail_menuname"/>
 	<result property="menuImg" column="menu_img"/>
</resultMap>

<insert id="create">
	insert into orderdetail (detail_order_no,detail_menu_no,detail_store_no,detail_count,detail_price,detail_subtotal,detail_menuname)
	values (#{orderNo}, #{menuNo}, #{storeNo},#{count},#{price},#{subTotal},#{menuName})
</insert>


<delete id="delete">
	delete
	from orderdetail
	where detail_order_no = #{orderNo}
</delete>

<!-- 
<select id="orderDetailList" resultMap="OrderDetilMap">
select * from orderdetail where detail_order_no= (
						select order_no from zicobell.order where 
						order_status=#{status} AND order_member_id=#{memberId})
</select>

 -->

<select id="orderDetailList" resultMap="OrderDetilMap">
select zmu.menu_img, odt.detail_count, odt.detail_menu_no, odt.detail_order_no, odt.detail_price, odt.detail_store_no,odt.detail_menuName,odt.detail_subtotal, odt.detail_token 
from zicobell.order zod inner join orderdetail odt
on zod.order_no = odt.detail_order_no left outer join zicobell.menu zmu
on odt.detail_menu_no = zmu.menu_no
where zod.order_member_id =#{memberId} and zod.order_status = #{status}
</select>

</mapper>